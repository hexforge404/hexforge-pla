{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://hexforge.internal/pla/v1/device_status.schema.json",
  "title": "Device Status",
  "description": "HID executor health and safety state report (HID Executor â†’ Brain)",
  "type": "object",
  "required": [
    "device_id",
    "timestamp",
    "mode",
    "led_state",
    "kill_switch_state",
    "uptime_seconds"
  ],
  "properties": {
    "device_id": {
      "type": "string",
      "description": "Unique identifier for this HID executor (serial number or MAC)",
      "pattern": "^[a-zA-Z0-9_:-]+$",
      "minLength": 8,
      "maxLength": 64
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp when status was generated",
      "format": "date-time"
    },
    "mode": {
      "type": "string",
      "description": "Current operating mode",
      "enum": ["OBSERVE", "SUGGEST", "EXECUTE"]
    },
    "led_state": {
      "type": "boolean",
      "description": "HID ARMED LED status (true=ON, false=OFF)"
    },
    "kill_switch_state": {
      "type": "string",
      "description": "Physical kill switch status",
      "enum": ["ARMED", "DISABLED", "UNKNOWN"]
    },
    "last_execution_time": {
      "type": "string",
      "description": "Optional: ISO 8601 timestamp of last HID action",
      "format": "date-time"
    },
    "error_state": {
      "type": "object",
      "description": "Optional: Current errors or warnings",
      "properties": {
        "has_error": {
          "type": "boolean"
        },
        "error_code": {
          "type": "string",
          "enum": [
            "NONE",
            "COMMAND_PARSE_ERROR",
            "BOUNDS_VIOLATION",
            "MODE_MISMATCH",
            "RATE_LIMIT_EXCEEDED",
            "USB_HID_FAILURE",
            "UNKNOWN_ERROR"
          ]
        },
        "error_message": {
          "type": "string",
          "maxLength": 500
        },
        "error_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Errors since boot"
        }
      },
      "required": ["has_error", "error_code"]
    },
    "uptime_seconds": {
      "type": "integer",
      "minimum": 0,
      "description": "Seconds since HID executor boot"
    },
    "firmware_version": {
      "type": "string",
      "description": "Optional: Firmware version string",
      "pattern": "^v?[0-9]+\\.[0-9]+\\.[0-9]+$"
    },
    "action_count": {
      "type": "integer",
      "minimum": 0,
      "description": "Optional: Total HID actions executed since boot"
    }
  }
}
